# MCAPIBridge éŸ³é¢‘ç³»ç»Ÿæ–‡æ¡£

#### [English](https://github.com/TaotianZhufang/MCAPIBridge/blob/main/Bridges/Python/PyAudio.MD) | ç®€ä½“ä¸­æ–‡

## ğŸ“š AudioManager ç±»

æ‰€æœ‰éŸ³é¢‘åŠŸèƒ½éƒ½é€šè¿‡ `mc.audio` è¿›è¡Œè®¿é—®ã€‚

```python
from mc import Minecraft

mc = Minecraft()
# é€šè¿‡ mc.audio è®¿é—®éŸ³é¢‘åŠŸèƒ½
```

---

## ğŸµ éŸ³é¢‘åŠ è½½ä¸ç®¡ç†

### `generateTone(target, audioId, frequency, duration, sampleRate)`

**åŠŸèƒ½**ï¼šç”Ÿæˆæ­£å¼¦æ³¢éŸ³è°ƒå¹¶ä¸Šä¼ è‡³å®¢æˆ·ç«¯ã€‚

**å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|-----------|------|-------------|---------|
| target | str | ç©å®¶åç§°ï¼Œ`""` ä»£è¡¨åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªç©å®¶ï¼Œ`"@a"` ä»£è¡¨æ‰€æœ‰åœ¨çº¿ç©å®¶ | å¿…å¡« |
| audioId | str | éŸ³é¢‘å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆè‡ªå®šä¹‰åç§°ï¼‰ | å¿…å¡« |
| frequency | float | é¢‘ç‡ (Hz) | 440 |
| duration | float | æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰ | 1.0 |
| sampleRate | int | é‡‡æ ·ç‡ | 44100 |

**ç¤ºä¾‹**ï¼š
```python
# ç”Ÿæˆ A4 éŸ³è°ƒ (440Hz)ï¼ŒæŒç»­ 2 ç§’
mc.audio.generateTone(player, "beep", 440, 2.0)
```

**å¸¸ç”¨é¢‘ç‡å‚è€ƒ**ï¼š
| éŸ³ç¬¦ | é¢‘ç‡ (Hz) |
|------|-----------|
| C4 (ä¸­å¤®C) | 262 |
| D4 | 294 |
| E4 | 330 |
| F4 | 349 |
| G4 | 392 |
| A4 | 440 |
| B4 | 494 |
| C5 | 523 |
| A5 | 880 |

### `loadWav(target, audioId, filepath)`

**åŠŸèƒ½**ï¼šå°†æœ¬åœ° WAV éŸ³é¢‘æ–‡ä»¶åŠ è½½è‡³å®¢æˆ·ç«¯ã€‚

**å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----------|------|-------------|
| target | str | ç©å®¶åç§° |
| audioId | str | éŸ³é¢‘å”¯ä¸€æ ‡è¯†ç¬¦ |
| filepath | str | æœ¬åœ° WAV æ–‡ä»¶è·¯å¾„ |

**æ”¯æŒæ ¼å¼**ï¼š
- 8ä½ æˆ– 16ä½ PCM
- å•å£°é“ æˆ– ç«‹ä½“å£°ï¼ˆè‡ªåŠ¨è½¬æ¢ä¸ºå•å£°é“ä»¥æ”¯æŒ3Dç©ºé—´åŒ–æ•ˆæœï¼‰
- ä»»æ„é‡‡æ ·ç‡

**ç¤ºä¾‹**ï¼š
```python
# åŠ è½½éŸ³ä¹æ–‡ä»¶
mc.audio.loadWav(player, "bgm", "music.wav")
```

**æ³¨æ„**ï¼š
- å¤§æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ†å—ä¼ è¾“ã€‚
- åŠ è½½åå»ºè®®åœ¨æ’­æ”¾å‰ç¨ä½œç­‰å¾…ï¼ˆå¯¹äºå¤§æ–‡ä»¶ï¼Œå»ºè®®ä½¿ç”¨ `time.sleep(1.0)` æˆ–æ›´é•¿æ—¶é—´ï¼‰ã€‚

### `loadRaw(target, audioId, pcmData, sampleRate)`

**åŠŸèƒ½**ï¼šåŠ è½½åŸå§‹ PCM éŸ³é¢‘æ•°æ®ï¼ˆå­—èŠ‚æµï¼‰ã€‚

**å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|-----------|------|-------------|---------|
| target | str | ç©å®¶åç§° | å¿…å¡« |
| audioId | str | éŸ³é¢‘å”¯ä¸€æ ‡è¯†ç¬¦ | å¿…å¡« |
| pcmData | bytes | 16ä½æœ‰ç¬¦å·æ•´æ•° PCM æ•°æ® | å¿…å¡« |
| sampleRate | int | é‡‡æ ·ç‡ | 44100 |

### `clone(target, sourceId, newId)`

**åŠŸèƒ½**ï¼šå…‹éš†ç°æœ‰çš„éŸ³é¢‘æºã€‚å¤ç”¨æºéŸ³é¢‘çš„å†…å­˜ç¼“å†²åŒºï¼Œä»è€ŒèŠ‚çœå¸¦å®½å’Œå†…å­˜ã€‚å¯¹äºå¤šéŸ³ç®±è®¾ç½®è‡³å…³é‡è¦ã€‚

**å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----------|------|-------------|
| target | str | ç©å®¶åç§° |
| sourceId | str | å·²åŠ è½½éŸ³é¢‘çš„ ID |
| newId | str | æ–°å®ä¾‹çš„ ID |

**ç¤ºä¾‹**ï¼š
```python
# åŠ è½½ä¸€æ¬¡
mc.audio.loadWav(player, "master", "music.wav")
# å…‹éš†å¤šæ¬¡
mc.audio.clone(player, "master", "speaker_1")
mc.audio.clone(player, "master", "speaker_2")
```

### `unload(target, audioId)`

**åŠŸèƒ½**ï¼šå¸è½½éŸ³é¢‘å¹¶é‡Šæ”¾å†…å­˜ã€‚

**å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----------|------|-------------|
| target | str | ç©å®¶åç§° |
| audioId | str | éŸ³é¢‘ ID |

---

## â–¶ï¸ æ’­æ”¾æ§åˆ¶å‡½æ•°

### `play(target, audioId, volume, loop)`

**åŠŸèƒ½**ï¼šæ™®é€š 2D æ’­æ”¾ï¼ˆæ— ç©ºé—´æ•ˆæœï¼Œè·Ÿéšç©å®¶ï¼‰ã€‚ç”¨äºèƒŒæ™¯éŸ³ä¹ (BGM) æˆ– UI éŸ³æ•ˆã€‚

**å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|-----------|------|-------------|---------|
| target | str | ç©å®¶åç§° | å¿…å¡« |
| audioId | str | å·²åŠ è½½çš„éŸ³é¢‘ ID | å¿…å¡« |
| volume | float | éŸ³é‡ (0.0 - 1.0) | 1.0 |
| loop | bool | æ˜¯å¦å¾ªç¯æ’­æ”¾ | False |

**ç¤ºä¾‹**ï¼š
```python
mc.audio.play(player, "bgm", volume=0.5, loop=True)
```

### `play3d(target, audioId, x, y, z, volume, rolloff, loop, dimension, offset)`

**åŠŸèƒ½**ï¼šåœ¨å›ºå®šä½ç½®æ’­æ”¾ 3D ç©ºé—´éŸ³é¢‘ã€‚

**å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|-----------|------|-------------|---------|
| target | str | ç©å®¶åç§° | å¿…å¡« |
| audioId | str | å·²åŠ è½½çš„éŸ³é¢‘ ID | å¿…å¡« |
| x, y, z | float | éŸ³æºä¸–ç•Œåæ ‡ | å¿…å¡« |
| volume | float | éŸ³é‡ (0.0 - 1.0) | 1.0 |
| rolloff | float | è·ç¦»è¡°å‡ç³»æ•° | 1.0 |
| loop | bool | æ˜¯å¦å¾ªç¯æ’­æ”¾ | False |
| dimension | str | ç»´åº¦ ID (ä¾‹å¦‚ `minecraft:the_nether`)ã€‚`""` = è‡ªåŠ¨æ£€æµ‹ã€‚ | `""` |
| offset | float | ä»ç¬¬ N ç§’å¼€å§‹æ’­æ”¾ | 0.0 |

**Rolloff å‚æ•°è¯´æ˜**ï¼š
| å€¼ | æ•ˆæœ |
|-------|--------|
| 0.5 | æ…¢è¡°å‡ï¼ˆè¿œå¤„ä¹Ÿèƒ½å¬æ¸…ï¼‰ |
| 1.0 | æ­£å¸¸è¡°å‡ |
| 2.0 | å¿«è¡°å‡ï¼ˆåªæœ‰è¿‘å¤„èƒ½å¬åˆ°ï¼‰ |

**ç¤ºä¾‹**ï¼š
```python
# åœ¨åæ ‡ (100, 64, 200) æ’­æ”¾
mc.audio.play3d(player, "sound", 100, 64, 200, volume=1.0, rolloff=1.0)
```

### `pause(target, audioId)`

**åŠŸèƒ½**ï¼šæš‚åœæ’­æ”¾ã€‚

**ç¤ºä¾‹**ï¼š
```python
mc.audio.pause(player, "music")
```

### `stop(target, audioId)`

**åŠŸèƒ½**ï¼šåœæ­¢æ’­æ”¾ï¼ˆé‡ç½®è¿›åº¦ï¼‰ã€‚

**ç¤ºä¾‹**ï¼š
```python
mc.audio.stop(player, "music")
```

---

## ğŸ›ï¸ éŸ³é¢‘å±æ€§å‡½æ•°

### `setVolume(target, audioId, volume)`

**åŠŸèƒ½**ï¼šåŠ¨æ€è°ƒæ•´æ­£åœ¨æ’­æ”¾éŸ³é¢‘çš„éŸ³é‡ã€‚

**å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----------|------|-------------|
| target | str | ç©å®¶åç§° |
| audioId | str | éŸ³é¢‘ ID |
| volume | float | éŸ³é‡ (0.0 - 1.0) |

**ç¤ºä¾‹**ï¼š
```python
mc.audio.setVolume(player, "music", 0.5)
```

### `setPosition(target, audioId, x, y, z)`

**åŠŸèƒ½**ï¼šæ›´æ–° 3D éŸ³æºçš„ä½ç½®ï¼ˆç”¨äºç§»åŠ¨éŸ³æºï¼‰ã€‚

**å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----------|------|-------------|
| target | str | ç©å®¶åç§° |
| audioId | str | éŸ³é¢‘ ID |
| x, y, z | float | æ–°çš„ä¸–ç•Œåæ ‡ |

**ç¤ºä¾‹**ï¼š
```python
# å°†å£°éŸ³ç§»åŠ¨åˆ°æ–°åæ ‡
mc.audio.setPosition(player, "moving_sound", 10, 65, 10)
```

### `syncProgress(audioId, progress)`

**åŠŸèƒ½**ï¼šæ‰‹åŠ¨åŒæ­¥æœåŠ¡ç«¯çš„æ’­æ”¾è®¡æ—¶å™¨ã€‚å¯¹äºé•¿è§†é¢‘å¾ˆæœ‰ç”¨ï¼Œç”¨äºæ ¡å‡†éŸ³é¢‘æ¼‚ç§»ã€‚

**å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----------|------|-------------|
| audioId | str | éŸ³é¢‘ ID |
| progress | float | å½“å‰æ—¶é—´æˆ³ï¼ˆç§’ï¼‰ |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1.  **åŠ è½½ç­‰å¾…æ—¶é—´**ï¼šéŸ³é¢‘åŠ è½½éœ€è¦æ—¶é—´ï¼ˆç½‘ç»œä¼ è¾“ï¼‰ã€‚å¯¹äºå¤§æ–‡ä»¶ (>5MB)ï¼Œå»ºè®®åœ¨è°ƒç”¨ `play` æˆ– `clone` å‰ä½¿ç”¨ `time.sleep(2.0)` æˆ–æ›´é•¿æ—¶é—´ã€‚
2.  **èµ„æºé‡Šæ”¾**ï¼šå½“ä¸å†éœ€è¦éŸ³é¢‘ ID æ—¶ï¼Œè¯·åŠ¡å¿…ä½¿ç”¨ `unload` é‡Šæ”¾å®¢æˆ·ç«¯å†…å­˜ã€‚
3.  **éŸ³é¢‘ ID å”¯ä¸€æ€§**ï¼šä½¿ç”¨å·²å­˜åœ¨çš„ ID ä¼šè¦†ç›–ä¹‹å‰çš„éŸ³é¢‘æ•°æ®ã€‚
4.  **WAV æ ¼å¼**ï¼šåº“æ”¯æŒ PCM WAVã€‚ä¸æ”¯æŒå‹ç¼©çš„ WAVã€‚
5.  **Target å‚æ•°**ï¼š
    *   `"PlayerName"` - æŒ‡å®šç©å®¶ã€‚
    *   `""` - åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªç©å®¶ã€‚
    *   `"@a"` - æ‰€æœ‰åœ¨çº¿ç©å®¶ã€‚

---

## ğŸ”§ å¿«é€Ÿå‚è€ƒ

```python
from mc import Minecraft

mc = Minecraft()
player = mc.getOnlinePlayers()[0]["name"]

# 1. ç”Ÿæˆ/åŠ è½½
mc.audio.generateTone(player, "id", frequency=440, duration=2.0)
# æˆ–è€…
mc.audio.loadWav(player, "id", "file.wav")

# 2. æ’­æ”¾
# 2D BGM
mc.audio.play(player, "id", volume=1.0, loop=False)
# 3D å®šä½
mc.audio.play3d(player, "id", x, y, z, volume=1.0, rolloff=1.0)

# 3. æ§åˆ¶
mc.audio.setVolume(player, "id", 0.5)
mc.audio.setPosition(player, "id", new_x, new_y, new_z)
mc.audio.pause(player, "id")
mc.audio.stop(player, "id")

# 4. æ¸…ç†
mc.audio.unload(player, "id")
```